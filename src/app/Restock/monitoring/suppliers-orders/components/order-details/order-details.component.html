<!-- order-details.component.html -->

    <!-- Modal Content -->
    <div class="modal-content">

      <!-- Step 1 -->
      <div *ngIf="step === 1">

        <div class="section-header">
          <h4 class="subtitle">Supplies</h4>
          <p class="section-description">View the supplies you have available for the order.</p>
        </div>

        <div class="table-container">
          <table mat-table [dataSource]="dataSource" class="supplies-table">

            <!-- Product Name Column -->
            <ng-container matColumnDef="productName">
              <th mat-header-cell *matHeaderCellDef>Product Name</th>
              <td mat-cell *matCellDef="let orderBatch">
                {{ productName(orderBatch.batch.supply.id) }}
              </td>
            </ng-container>

            <!-- Quantity Column -->
            <ng-container matColumnDef="quantity">
              <th mat-header-cell *matHeaderCellDef>Quantity</th>
              <td mat-cell *matCellDef="let orderBatch">
                {{ orderBatch.quantity }}
              </td>
            </ng-container>

            <!-- Unit Measure Column -->
            <ng-container matColumnDef="unitMeasure">
              <th mat-header-cell *matHeaderCellDef>Unit Measure</th>
              <td mat-cell *matCellDef="let orderBatch">
                {{ orderBatch.batch.supply.unit_measurement.name }}
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>

          <mat-paginator  #paginator
                          [pageSize]="4"
                          [pageSizeOptions]="[2, 3, 4]"
                          [length]="dataSource.data.length"
                          showFirstLastButtons>

          </mat-paginator>
        </div>

        <div class="total-price">
          <strong>Total Price: ${{ this.order?.total_price }}</strong>
        </div>
        @if(hideState)
        {
          <!-- Situation Chip -->
          <div class="situation">
            <h4 class="subtitle">
              Situation
              <mat-chip class="situation-chip">{{ order?.situation?.name || 'Unknown' }}</mat-chip>
            </h4>
          </div>
        }
        @else
        {
          <!-- State Stepper -->
          <div class="state-dragger">
            <h4 class="subtitle">State</h4>

            <div class="stepper-container">
              <!-- Progress Line -->
              <div class="progress-line">
                <div class="progress-fill" [style.width]="getProgressWidth()"></div>
              </div>

              <!-- Steps -->
              <div class="steps-wrapper">
                <div
                  *ngFor="let stepName of steps; let i = index"
                  class="step-item"
                >
                  <!-- Truck Icon -->
                  <div *ngIf="computedCurrentIndex === i" class="truck-container">
                    <mat-icon class="truck-icon">local_shipping</mat-icon>
                  </div>

                  <!-- Step Point -->
                  <div class="step-point" [ngClass]="getStepClass(i)">
                    <mat-icon *ngIf="computedCurrentIndex > i" class="check-icon">check</mat-icon>
                  </div>

                  <!-- Step Label -->
                  <span class="step-label" [class.active]="computedCurrentIndex === i">
                  {{ stepName }}
                </span>
                </div>
              </div>
            </div>
          </div>
        }

      </div>

      <!-- Step 2: Summary -->
      <div *ngIf="step === 2">
        <div class="restaurant-section">
          <p class="subtitle">Restaurant Name:</p>
          <p class="value">{{ adminRestaurantName }}</p>
        </div>

        <div class="date-section">
          <p class="subtitle">Estimated Ship Date and Time:</p>
          <p class="value">{{ this.order?.estimated_ship_date | date }}, {{ this.order?.estimated_ship_time | date:'shortTime'}}</p>
        </div>

        <div class="description-section">
          <p class="subtitle">Order Description</p>
          <p class="value">{{ this.order?.description }}</p>
        </div>
      </div>
    </div>

    <!-- Modal Footer -->
    <div class="modal-footer">
      <div class="footer-left">
        <button *ngIf="step === 2" mat-button class="btn-back" (click)="prevStep()">
          Back
        </button>
        <button mat-button class="btn-close" (click)="onClose()">
          Close
        </button>
      </div>

      <div class="footer-right">
        <button *ngIf="step === 1" mat-raised-button color="primary" (click)="nextStep()">
          Next
        </button>
      </div>
    </div>

